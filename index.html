<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malayalam Typing Judge Extension Generator</title>
    
    <!-- Include JSZip library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- Link to CSS file -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>üéØ Malayalam Typing Judge Extension Generator</h1>
        <p>Create a Chrome extension that judges your typing speed in real-time with Malayalam audio commentary!</p>
        
        <!-- Demo Section -->
        <div class="form-group demo-section">
            <h3>üéÆ Try Demo First!</h3>
            <p>Download a working demo extension with sample beep sounds to test how it works on YouTube, Gmail, WhatsApp Web, Discord, and all other websites!</p>
            <button onclick="createDemoExtension()" id="demoBtn" class="demo-button">
                üéØ Download Demo Extension (With Sample Audio)
            </button>
            <small>Try the demo first to see how it detects typing everywhere, then create your custom Malayalam version below!</small>
        </div>
        
        <hr style="margin: 30px 0; border: 1px solid rgba(0,0,0,0.1);">
        
        <!-- Custom Extension Section -->
        <div class="form-group">
            <h3>üéµ Create Your Custom Malayalam Version</h3>
            
            <!-- Threshold Input Section -->
            <label for="threshold">‚ö° Typing Speed Threshold (Characters Per Second):</label>
            <input type="number" id="threshold" value="2" min="0.5" max="10" step="0.1">
            <div class="speed-info">
                <strong>Speed Guide:</strong><br>
                ‚Ä¢ Below 2 CPS = Slow (gets insults)<br>
                ‚Ä¢ 2-4 CPS = Medium (neutral sounds)<br>
                ‚Ä¢ Above 4 CPS = Fast (gets praise)
            </div>
        </div>

        <div class="form-group" id="audioUploadSection">
            <label>üéµ Upload Your Malayalam Audio Files:</label>
            
            <label for="audioFileSlow">üêå Slow Typing Audio (insults):</label>
            <input type="file" id="audioFileSlow" accept=".mp3,.wav,.ogg">
            
            <label for="audioFileMedium">‚öñÔ∏è Medium Typing Audio (neutral):</label>
            <input type="file" id="audioFileMedium" accept=".mp3,.wav,.ogg">
            
            <label for="audioFileFast">üöÄ Fast Typing Audio (praise):</label>
            <input type="file" id="audioFileFast" accept=".mp3,.wav,.ogg">
        </div>
        
        <!-- Generate Button -->
        <button onclick="generateExtension()" id="generateBtn">
            üöÄ Generate Custom Malayalam Extension
        </button>
        
        <!-- Status Messages -->
        <div id="status"></div>
        
        <!-- Installation Instructions -->
        <div class="form-group">
            <h3>üìù How to Install Extensions:</h3>
            <ol>
                <li>Download the ZIP file (demo or custom)</li>
                <li>Unzip it to a folder on your computer</li>
                <li>Open Chrome ‚Üí go to <code>chrome://extensions/</code></li>
                <li>Turn on "Developer mode" (top right toggle)</li>
                <li>Click "Load unpacked" and select your unzipped folder</li>
                <li>Start typing anywhere and get judged! üé≠</li>
            </ol>
            
            <h4>üåê Works On All These Websites:</h4>
            <ul>
                <li>‚úÖ YouTube comments</li>
                <li>‚úÖ Gmail compose</li>
                <li>‚úÖ WhatsApp Web messages</li>
                <li>‚úÖ Discord chat</li>
                <li>‚úÖ Twitter/X posts</li>
                <li>‚úÖ Facebook posts/comments</li>
                <li>‚úÖ Instagram comments</li>
                <li>‚úÖ Reddit posts/comments</li>
                <li>‚úÖ Any text input field!</li>
            </ul>
        </div>
    </div>

    <!-- Include all JavaScript files in order -->
    <script src="scriptTemplate.js"></script>
    <script src="zipCreator.js"></script>
    <script src="script.js"></script>
    
    <script>
        // Create demo audio files as base64 encoded beep sounds
        function createDemoAudioFile(frequency, duration) {
            const sampleRate = 22050;
            const samples = sampleRate * duration;
            const buffer = new ArrayBuffer(44 + samples * 2);
            const view = new DataView(buffer);
            
            // WAV header
            const writeString = (offset, string) => {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            };
            
            writeString(0, 'RIFF');
            view.setUint32(4, 36 + samples * 2, true);
            writeString(8, 'WAVE');
            writeString(12, 'fmt ');
            view.setUint32(16, 16, true);
            view.setUint16(20, 1, true);
            view.setUint16(22, 1, true);
            view.setUint32(24, sampleRate, true);
            view.setUint32(28, sampleRate * 2, true);
            view.setUint16(32, 2, true);
            view.setUint16(34, 16, true);
            writeString(36, 'data');
            view.setUint32(40, samples * 2, true);
            
            // Generate sine wave
            for (let i = 0; i < samples; i++) {
                const sample = Math.sin(2 * Math.PI * frequency * i / sampleRate) * 0.3;
                view.setInt16(44 + i * 2, sample * 32767, true);
            }
            
            return new Uint8Array(buffer);
        }

        // Demo extension creation function
        async function createDemoExtension() {
            console.log('Creating demo extension with sample audio...');
            
            showLoading();
            document.getElementById('demoBtn').disabled = true;
            document.getElementById('demoBtn').textContent = 'üîÑ Creating Demo...';
            
            try {
                const zip = new JSZip();
                
                // Create manifest for demo
                const demoManifest = {
                    "manifest_version": 3,
                    "name": "Malayalam Typing Judge - DEMO",
                    "version": "1.0",
                    "description": "Demo version with sample beep sounds - Works on ALL websites!",
                    "permissions": [],
                    "content_scripts": [
                        {
                            "matches": ["<all_urls>"],
                            "js": ["script.js"]
                        }
                    ],
                    "web_accessible_resources": [
                        {
                            "resources": ["audio/*.wav"],
                            "matches": ["<all_urls>"]
                        }
                    ]
                };
                
                // Create demo script with 2 CPS threshold
                const demoScript = createScriptContent(2).replace(/\.mp3/g, '.wav');
                
                // Add files to ZIP
                zip.file("manifest.json", JSON.stringify(demoManifest, null, 2));
                zip.file("script.js", demoScript);
                
                // Create audio folder with demo audio files
                const audioFolder = zip.folder("audio");
                
                // Generate different beep sounds for each speed
                audioFolder.file("slow.wav", createDemoAudioFile(200, 0.5)); // Low frequency for slow
                audioFolder.file("medium.wav", createDemoAudioFile(400, 0.3)); // Medium frequency for medium
                audioFolder.file("fast.wav", createDemoAudioFile(800, 0.2)); // High frequency for fast
                
                // Create README content for demo
                const demoReadmeContent = `# Malayalam Typing Judge - DEMO Extension

This is a demo version with sample beep sounds to show how the extension works.

## What it does:
- Monitors your typing speed on ALL websites
- Plays different beep sounds based on your typing speed:
  - Slow typing (< 2 CPS): Low beep
  - Medium typing (2-4 CPS): Medium beep  
  - Fast typing (> 4 CPS): High beep

## Test it on:
- YouTube comments
- Gmail compose
- Discord chat
- Any text input field!

## Next step:
Go back to the generator website and create your custom version with Malayalam audio files!

Made with ‚ù§Ô∏è at TinkerHub Useless Projects`;
                
                zip.file("README.md", demoReadmeContent);
                
                // Generate and download
                const content = await zip.generateAsync({type: "blob"});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(content);
                link.download = 'malayalam-typing-judge-DEMO.zip';
                link.click();
                
                showSuccess('Demo extension created! Install it to see how it detects typing everywhere. Then create your custom version with Malayalam audio!');
                
            } catch (error) {
                console.error('Error creating demo:', error);
                showError('Failed to create demo extension: ' + error.message);
            } finally {
                hideLoading();
                document.getElementById('demoBtn').disabled = false;
                document.getElementById('demoBtn').textContent = 'üéØ Download Demo Extension (With Sample Audio)';
            }
        }
    </script>
</body>
</html>